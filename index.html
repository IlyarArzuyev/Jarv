<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>JARVIS + Claude + Open Apps</title>
  <style>
    html,body{margin:0;padding:0;height:100%;overflow:hidden;background:black;font-family:'Segoe UI',sans-serif;user-select:none}
    .center, .hud-container{display:flex;justify-content:center;align-items:center;height:100%;position:relative}
    #voiceBtn{width:140px;height:140px;background:url('IMG_9435.jpeg')center/cover no-repeat;border:4px solid #00ffff;border-radius:50%;box-shadow:0 0 20px #00ffff,inset 0 0 30px #00ffff;cursor:pointer;transition:.3s;z-index:10}
    #voiceBtn.active{box-shadow:0 0 50px #00ffff,0 0 100px #00ffff,inset 0 0 60px #00ffff;transform:scale(1.05)}
    #status{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:#00ffff;background:rgba(0,255,255,0.1);padding:10px 20px;border:1px solid #00ffff55;border-radius:10px;backdrop-filter:blur(6px);text-shadow:0 0 5px #00ffff;font-size:16px;z-index:99}
    .scanner-line{position:absolute;width:2px;height:100px;background:#00ffff88;animation:scanY 2s linear infinite}
    .scanner-line.left{left:20px}
    .scanner-line.right{right:20px}
    @keyframes scanY{0%{top:0;opacity:0}50%{opacity:1}100%{top:100%;opacity:0}}
    .grid{position:absolute;width:100%;height:100%;pointer-events:none;z-index:0}
    .grid svg{width:100%;height:100%;opacity:0.05}
  </style>
</head>
<body>
  <div class="hud-container">
    <div class="scanner-line left"></div>
    <div class="scanner-line right"></div>
    <div class="grid">
      <svg viewBox="0 0 100 100" preserveAspectRatio="none">
        <defs>
          <pattern id="g" width="10" height="10" patternUnits="userSpaceOnUse">
            <path d="M10 0L0 0 0 10" fill="none" stroke="#00ffff" stroke-width="0.3"/>
          </pattern>
        </defs>
        <rect width="100%" height="100%" fill="url(#g)"/>
      </svg>
    </div>
    <div class="center">
      <button id="voiceBtn" title="–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞"></button>
    </div>
  </div>
  <div id="status">üîä –ó–∞–≥—Ä—É–∑–∫–∞...</div>
  <audio id="introAudio" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>

  <script>
    document.addEventListener('contextmenu',e=>e.preventDefault());
    document.addEventListener('wheel',e=>{if(e.ctrlKey)e.preventDefault()}, {passive:false});

    const voiceBtn = document.getElementById('voiceBtn');
    const status = document.getElementById('status');
    const intro = document.getElementById('introAudio');

    const SR = window.SpeechRecognition||window.webkitSpeechRecognition;
    const rec = new SR();
    rec.lang='ru-RU'; rec.continuous=false; rec.interimResults=false;
    let listening=false, lastText='', timeoutID=null;

    const part1='sk-ant-';
    const part2='api03-1uqemFV5tdYVeN53GAMnJzutPCblJ73wTR0-16Y_2wQKOP4gBKT16tYhoRcMfuZEbjwhe0k6SfDaruxaogc1Dg-LB31uQAA';
    
    
    const apiKey = part1+part2;

    function speak(txt,cb){
      const u=new SpeechSynthesisUtterance(txt);
      u.lang='ru-RU'; u.pitch=0.8; u.rate=1.05; u.volume=1;
      if(cb)u.onend=cb;
      speechSynthesis.speak(u);
    }

    async function askClaude(prompt){
      status.textContent='ü§ñ –ó–∞–ø—Ä–æ—Å –∫ Claude...';
      try{
        const res=await fetch('https://api.anthropic.com/v1/messages',{
          method:'POST',
          headers:{'x-api-key':apiKey,'anthropic-version':'2023-06-01','Content-Type':'application/json'},
          body:JSON.stringify({model:'claude-3-haiku-20240307',max_tokens:100,messages:[{role:'user',content:prompt}]})
        });
        const j=await res.json();
        const reply=j.content?.[0]?.text||'–ò–∑–≤–∏–Ω–∏—Ç–µ, –Ω–µ –ø–æ–Ω—è–ª.';
        status.textContent='‚úÖ –°–æ–±–∏—Ä–∞—é—Å—å –æ—Ç–≤–µ—Ç–∏—Ç—å';
        speak(reply);
      }catch(e){
        status.textContent='‚ö†Ô∏è –û—à–∏–±–∫–∞ Claude';
      }
    }

    const appURIs = {
      '—Ç–µ–ª–µ–≥—Ä–∞–º':'tg://',
      '–≤–∞—Ç—Å–∞–ø':'whatsapp://',
      '—é—Ç—É–±':'youtube://',
      '–∏–Ω—Å—Ç–∞–≥—Ä–∞–º':'instagram://',
      '—Ç–∏–∫ —Ç–æ–∫':'snssdk1128://',
      '–∫–∞—Å–ø–∏':'kaspi://'
    };

    function checkApps(text){
      for(let k in appURIs){
        if(text.includes(k)){
          status.textContent=`üîó –ó–∞–ø—É—Å–∫ ${k}`;
          speak(`–û—Ç–∫—Ä—ã–≤–∞—é ${k}`);
          window.location.href=appURIs[k];
          return true;
        }
      }
      return false;
    }

    rec.onresult=e=>{
      lastText=e.results[0][0].transcript.trim().toLowerCase();
      status.textContent=`üéôÔ∏è –°–ª—É—à–∞—é: "${lastText}"`;
      if(timeoutID)clearTimeout(timeoutID);
      timeoutID=setTimeout(()=>{
        if(!checkApps(lastText)) askClaude(lastText);
        lastText=''; if(listening)rec.start();
      },800);
    };
    rec.onend=()=>{if(listening && !lastText)rec.start();}
    rec.onerror=e=>{if(listening)rec.start();}

    function start(){
      listening=true; rec.start(); voiceBtn.classList.add('active');
      status.textContent='üéôÔ∏è –°–ª—É—à–∞—é –ø–æ—Å—Ç–æ—è–Ω–Ω–æ';
    }
    function stop(){
      listening=false; rec.stop(); voiceBtn.classList.remove('active');
      status.textContent='üîá –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ';
    }

    intro.play().then(()=>{
      status.textContent='‚ñ∂Ô∏è –°–ª—É—à–∞—é –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ...';
    }).catch(()=>{status.textContent='‚ö†Ô∏è –†–∞–∑—Ä–µ—à–∏—Ç–µ –∑–≤—É–∫ –∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω';});
    intro.onended=()=>{
      speak('–ö –≤–∞—à–∏–º —É—Å–ª—É–≥–∞–º —Å—ç—Ä',start);
    };

    voiceBtn.onclick=()=>{
      if(!listening) speak('–ê–∫—Ç–∏–≤–∏—Ä—É—é –≥–æ–ª–æ—Å–æ–≤–æ–π —Ä–µ–∂–∏–º',start);
      else stop();
    };
  </script>
</body>
</html>